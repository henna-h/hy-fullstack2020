(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{39:function(e,t,n){e.exports=n(69)},49:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(16),u=n.n(c),o=n(14),i=(n(49),n(38)),l=n(1),s=n.n(l),f=n(3),d=n(6),p=a.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(d.a)(n,2),u=c[0],o=c[1],i={display:u?"none":""},l={display:u?"":"none"},s=function(){o(!u)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:s}})),a.a.createElement("div",null,a.a.createElement("div",{style:i},a.a.createElement("button",{onClick:s},e.buttonLabel)),a.a.createElement("div",{style:l},e.children,a.a.createElement("button",{onClick:s},e.closingButtonLabel)))}));p.displayName="Togglable";var m=p,b=function(e){var t=e.blog,n=e.user,c=e.deleteBlog,u=e.onLike;console.log(n),console.log(t);var o=Object(r.useRef)(),i=function(){var e=Object(f.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.confirm("Are you sure you want to delete "+t.title+" by "+t.author)&&c(t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5}},a.a.createElement("div",{id:"title-and-author",className:"visibleWhenNotToggled"},t.title," ",t.author),a.a.createElement(m,{buttonLabel:"view",closingButtonLabel:"hide",ref:o},t.url,a.a.createElement("br",null),"likes ",t.likes," ",a.a.createElement("button",{className:"like",onClick:function(){return u(t)}},"like"),a.a.createElement("br",null),t.user.name,a.a.createElement((function(){return n.username===t.user.username||n._id===t.user?a.a.createElement("button",{onClick:i},"delete"):null}),null)))},v=Object(o.b)((function(e){return{successNotification:e.successNotification,errorNotification:e.errorNotification}}))((function(e){return null!==e.errorNotification?a.a.createElement("div",{className:"error"},e.errorNotification.text):null!==e.successNotification?a.a.createElement("div",{className:"success"},e.successNotification.text):null})),g=function(e){var t=e.handleSubmit,n=e.handleUsernameChange,r=e.handlePasswordChange,c=e.username,u=e.password;return a.a.createElement("div",null,a.a.createElement("h2",null,"Login"),a.a.createElement("form",{onSubmit:t},a.a.createElement("div",null,"username",a.a.createElement("input",{id:"username",value:c,onChange:n})),a.a.createElement("div",null,"password",a.a.createElement("input",{id:"password",type:"password",value:u,onChange:r})),a.a.createElement("button",{id:"login-button",type:"submit"},"login")))},E=function(e){var t=e.createBlog,n=Object(r.useState)(""),c=Object(d.a)(n,2),u=c[0],o=c[1],i=Object(r.useState)(""),l=Object(d.a)(i,2),p=l[0],m=l[1],b=Object(r.useState)(""),v=Object(d.a)(b,2),g=v[0],E=v[1],h=function(){var e=Object(f.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),t({title:u,author:p,url:g}),o(""),m(""),E("");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("form",{onSubmit:h},a.a.createElement("div",null,"Title: ",a.a.createElement("input",{id:"title",value:u,onChange:function(e){o(e.target.value)}})),a.a.createElement("div",null,"Author: ",a.a.createElement("input",{id:"author",value:p,onChange:function(e){m(e.target.value)}})),a.a.createElement("div",null,"Url: ",a.a.createElement("input",{id:"url",value:g,onChange:function(e){E(e.target.value)}})),a.a.createElement("button",{id:"create-button",type:"submit"},"create"))},h=n(10),O=n.n(h),w=function(){return O.a.get("/api/users").then((function(e){return e.data}))},N=function(){var e=Object(r.useState)([]),t=Object(d.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){w().then((function(e){return c(e)}))}),[]),a.a.createElement("div",null,a.a.createElement("h1",null,"Users"),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("th",null,"Name"),a.a.createElement("th",null,"Blogs created")),n.map((function(e){return a.a.createElement("tr",{key:e.id},a.a.createElement("td",null,e.name),a.a.createElement("td",null,e.blogs.length))})))))},j=null,y={getAll:function(){return O.a.get("/api/blogs").then((function(e){return e.data}))},create:function(){var e=Object(f.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:j}},e.next=3,O.a.post("/api/blogs",t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return O.a.put("".concat("/api/blogs","/").concat(e),t).then((function(e){return e.data}))},remove:function(){var e=Object(f.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:j}},e.next=3,O.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){j="bearer ".concat(e)}},k={login:function(){var e=Object(f.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},S=function(){return function(){var e=Object(f.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"REMOVE_NOTIFICATION"});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SUCCESS_NOTIFICATION":return null!==e&&clearTimeout(e.timer),t.data;case"REMOVE_NOTIFICATION":return null;default:return e}},I=function(){return function(){var e=Object(f.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"REMOVE_NOTIFICATION"});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ERROR_NOTIFICATION":return null!==e&&clearTimeout(e.timer),t.data;case"REMOVE_NOTIFICATION":return null;default:return e}},x=n(17),A=n(2),B={setSuccessNotification:function(e,t){return function(){var n=Object(f.a)(s.a.mark((function n(r){return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r({type:"SET_SUCCESS_NOTIFICATION",data:{text:e,timer:setTimeout((function(){r(S())}),t)}});case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},setErrorNotification:function(e,t){return function(){var n=Object(f.a)(s.a.mark((function n(r){return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r({type:"SET_ERROR_NOTIFICATION",data:{text:e,timer:setTimeout((function(){r(I())}),t)}});case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},R=Object(o.b)((function(e){return{successNotification:e.successNotification,errorNotification:e.errorNotification}}),B)((function(e){var t=Object(r.useRef)(),n=Object(r.useState)([]),c=Object(d.a)(n,2),u=c[0],o=c[1],l=Object(r.useState)(""),p=Object(d.a)(l,2),h=p[0],O=p[1],w=Object(r.useState)(""),j=Object(d.a)(w,2),S=j[0],T=j[1],I=Object(r.useState)(null),C=Object(d.a)(I,2),B=C[0],R=C[1];Object(r.useEffect)((function(){y.getAll().then((function(e){return o(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogAppUser");if(e){var t=JSON.parse(e);R(t),y.setToken(t.token)}}),[]);var _=function(n){t.current.toggleVisibility(),y.create(n).then((function(t){o(u.concat(t)),e.setSuccessNotification("New blog added: "+t.title+" by "+t.author,5e3)})).catch=function(){e.setErrorNotification("something went wrong",5e3)}},L=function(){var t=Object(f.a)(s.a.mark((function t(n){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),console.log("logging in with ",h,S),t.prev=2,t.next=5,k.login({username:h,password:S});case 5:r=t.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(r)),y.setToken(r.token),R(r),O(""),T(""),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),e.setErrorNotification("wrong username or password",5e3);case 16:case"end":return t.stop()}}),t,null,[[2,13]])})));return function(e){return t.apply(this,arguments)}}(),U=function(){var e=Object(f.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedBlogAppUser"),R(null);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(f.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(i.a)({},t,{likes:t.likes+1,user:t.user.id}),console.log(B),console.log(t.user.id),console.log(t.id,n),e.next=6,y.update(t.id,n);case 6:o(u.map((function(e){return e.id!==t.id?n:e})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var t=Object(f.a)(s.a.mark((function t(n){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.remove(n);case 2:r=u.filter((function(e){return e.id!==n})),o(r),e.setSuccessNotification("Blog deleted!",5e3);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement(v,null),null===B&&a.a.createElement("div",null,a.a.createElement(g,{username:h,password:S,handleUsernameChange:function(e){var t=e.target;return O(t.value)},handlePasswordChange:function(e){var t=e.target;return T(t.value)},handleSubmit:L})),null!==B&&a.a.createElement("div",null,a.a.createElement("p",null,B.name," logged in "),a.a.createElement("button",{type:"submit",onClick:U},"logout")),null!==B&&a.a.createElement("div",null,a.a.createElement(x.b,{to:"/users"},"users")),a.a.createElement(A.c,null,a.a.createElement(A.a,{path:"/users"},null!==B&&a.a.createElement("div",null,a.a.createElement(N,null))),a.a.createElement(A.a,{path:"/"},a.a.createElement("h2",null,"blogs"),null!==B&&a.a.createElement("div",null,a.a.createElement(m,{buttonLabel:"add blog",closingButtonLabel:"cancel",ref:t},a.a.createElement(E,{createBlog:_}))),null!==B&&(u.sort((function(e,t){return t.likes-e.likes})),a.a.createElement("div",null,u.map((function(e){return a.a.createElement(b,{key:e.id,blog:e,user:B,deleteBlog:V,onLike:F,className:"blog"})})))))))})),_=n(11),L=n(36),U=n(37),F=Object(_.combineReducers)({successNotification:T,errorNotification:C}),V=Object(_.createStore)(F,Object(U.composeWithDevTools)(Object(_.applyMiddleware)(L.a)));u.a.render(a.a.createElement(o.a,{store:V},a.a.createElement(x.a,null,a.a.createElement(R,null))),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.ce4fc850.chunk.js.map