(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{24:function(e,t,n){e.exports=n(56)},37:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(8),c=n.n(o),u=n(7),i=(n(37),n(1)),l=n.n(i),s=n(2),f=n(4),d=a.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),o=Object(f.a)(n,2),c=o[0],u=o[1],i={display:c?"none":""},l={display:c?"":"none"},s=function(){u(!c)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:s}})),a.a.createElement("div",null,a.a.createElement("div",{style:i},a.a.createElement("button",{onClick:s},e.buttonLabel)),a.a.createElement("div",{style:l},e.children,a.a.createElement("button",{onClick:s},e.closingButtonLabel)))}));d.displayName="Togglable";var p=d,m=function(e){var t=e.blog,n=e.user,o=e.deleteBlog,c=e.onLike;console.log(n),console.log(t.user.username);var u=Object(r.useRef)(),i=function(){var e=Object(s.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.confirm("Are you sure you want to delete "+t.title+" by "+t.author)&&o(t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5}},a.a.createElement("div",{id:"title-and-author",className:"visibleWhenNotToggled"},t.title," ",t.author),a.a.createElement(p,{buttonLabel:"view",closingButtonLabel:"hide",ref:u},t.url,a.a.createElement("br",null),"likes ",t.likes," ",a.a.createElement("button",{className:"like",onClick:function(){return c(t)}},"like"),a.a.createElement("br",null),t.user.name,a.a.createElement((function(){return n.username===t.user.username||n._id===t.user?a.a.createElement("button",{onClick:i},"delete"):null}),null)))},b=Object(u.b)((function(e){return{successNotification:e.successNotification,errorNotification:e.errorNotification}}))((function(e){return null!==e.errorNotification?a.a.createElement("div",{className:"error"},e.errorNotification.text):null!==e.successNotification?a.a.createElement("div",{className:"success"},e.successNotification.text):null})),v=function(e){var t=e.handleSubmit,n=e.handleUsernameChange,r=e.handlePasswordChange,o=e.username,c=e.password;return a.a.createElement("div",null,a.a.createElement("h2",null,"Login"),a.a.createElement("form",{onSubmit:t},a.a.createElement("div",null,"username",a.a.createElement("input",{id:"username",value:o,onChange:n})),a.a.createElement("div",null,"password",a.a.createElement("input",{id:"password",type:"password",value:c,onChange:r})),a.a.createElement("button",{id:"login-button",type:"submit"},"login")))},g=function(e){var t=e.createBlog,n=Object(r.useState)(""),o=Object(f.a)(n,2),c=o[0],u=o[1],i=Object(r.useState)(""),d=Object(f.a)(i,2),p=d[0],m=d[1],b=Object(r.useState)(""),v=Object(f.a)(b,2),g=v[0],h=v[1],E=function(){var e=Object(s.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),t({title:c,author:p,url:g}),u(""),m(""),h("");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("form",{onSubmit:E},a.a.createElement("div",null,"Title: ",a.a.createElement("input",{id:"title",value:c,onChange:function(e){u(e.target.value)}})),a.a.createElement("div",null,"Author: ",a.a.createElement("input",{id:"author",value:p,onChange:function(e){m(e.target.value)}})),a.a.createElement("div",null,"Url: ",a.a.createElement("input",{id:"url",value:g,onChange:function(e){h(e.target.value)}})),a.a.createElement("button",{id:"create-button",type:"submit"},"create"))},h=n(6),E=n.n(h),O=null,w={getAll:function(){return E.a.get("/api/blogs").then((function(e){return e.data}))},create:function(){var e=Object(s.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,E.a.post("/api/blogs",t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return E.a.put("".concat("/api/blogs","/").concat(e),t).then((function(e){return e.data}))},remove:function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,E.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){O="bearer ".concat(e)}},N={login:function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},j=function(){return function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"REMOVE_NOTIFICATION"});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SUCCESS_NOTIFICATION":return null!==e&&clearTimeout(e.timer),t.data;case"REMOVE_NOTIFICATION":return null;default:return e}},k=function(){return function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"REMOVE_NOTIFICATION"});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ERROR_NOTIFICATION":return null!==e&&clearTimeout(e.timer),t.data;case"REMOVE_NOTIFICATION":return null;default:return e}},S={setSuccessNotification:function(e,t){return function(){var n=Object(s.a)(l.a.mark((function n(r){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r({type:"SET_SUCCESS_NOTIFICATION",data:{text:e,timer:setTimeout((function(){r(j())}),t)}});case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},setErrorNotification:function(e,t){return function(){var n=Object(s.a)(l.a.mark((function n(r){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r({type:"SET_ERROR_NOTIFICATION",data:{text:e,timer:setTimeout((function(){r(k())}),t)}});case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},I=Object(u.b)((function(e){return{successNotification:e.successNotification,errorNotification:e.errorNotification}}),S)((function(e){var t=Object(r.useRef)(),n=Object(r.useState)([]),o=Object(f.a)(n,2),c=o[0],u=o[1],i=Object(r.useState)(""),d=Object(f.a)(i,2),h=d[0],E=d[1],O=Object(r.useState)(""),j=Object(f.a)(O,2),y=j[0],k=j[1],T=Object(r.useState)(null),S=Object(f.a)(T,2),I=S[0],C=S[1];Object(r.useEffect)((function(){w.getAll().then((function(e){return u(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogAppUser");if(e){var t=JSON.parse(e);C(t),w.setToken(t.token)}}),[]);var x=function(n){t.current.toggleVisibility(),w.create(n).then((function(t){u(c.concat(t)),e.setSuccessNotification("New blog added: "+t.title+" by "+t.author,5e3)})).catch=function(){e.setErrorNotification("something went wrong",5e3)}},A=function(){var t=Object(s.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),console.log("logging in with ",h,y),t.prev=2,t.next=5,N.login({username:h,password:y});case 5:r=t.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(r)),w.setToken(r.token),C(r),E(""),k(""),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),e.setErrorNotification("wrong username or password",5e3);case 16:case"end":return t.stop()}}),t,null,[[2,13]])})));return function(e){return t.apply(this,arguments)}}(),R=function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedBlogAppUser"),C(null);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(e){var t={title:e.title,author:e.author,url:e.url,user:e.user,likes:e.likes+1};console.log(e.id,t),w.update(e.id,t).then((function(t){u(c.map((function(n){return n.id!==e.id?n:t})))}))},_=function(){var t=Object(s.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.remove(n);case 2:r=c.filter((function(e){return e.id!==n})),u(r),e.setSuccessNotification("Blog deleted!",5e3);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement(b,null),a.a.createElement("h2",null,"blogs"),null!==I&&a.a.createElement("div",null,a.a.createElement("p",null,I.name," logged in "),a.a.createElement("button",{type:"submit",onClick:R},"logout")),null!==I&&a.a.createElement("div",null,a.a.createElement(p,{buttonLabel:"add blog",closingButtonLabel:"cancel",ref:t},a.a.createElement(g,{createBlog:x}))),null===I&&a.a.createElement("div",null,a.a.createElement(v,{username:h,password:y,handleUsernameChange:function(e){var t=e.target;return E(t.value)},handlePasswordChange:function(e){var t=e.target;return k(t.value)},handleSubmit:A})),null!==I&&(c.sort((function(e,t){return t.likes-e.likes})),a.a.createElement("div",null,c.map((function(e){return a.a.createElement(m,{key:e.id,blog:e,user:I,deleteBlog:_,onLike:B,className:"blog"})})))))})),C=n(5),x=n(22),A=n(23),R=Object(C.combineReducers)({successNotification:y,errorNotification:T}),B=Object(C.createStore)(R,Object(A.composeWithDevTools)(Object(C.applyMiddleware)(x.a)));c.a.render(a.a.createElement(u.a,{store:B},a.a.createElement(I,null)),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.093e1c14.chunk.js.map